{"version":3,"names":["PictureInPictureLayout","props","config","foregroundBuilder","audioVideoConfig","isSmallViewDraggable","showMyViewWithVideoOnly","smallViewBackgroundColor","largeViewBackgroundColor","smallViewBackgroundImage","largeViewBackgroundImage","smallViewPostion","switchLargeOrSmallViewByClick","useVideoViewAspectFill","showSoundWavesInAudioMode","localUserID","setLocalUserID","useState","remoteUserID","setRemoteUserID","showMeOnSmallView","setShowMeOnSmallView","useEffect","callbackID","String","Math","floor","random","ZegoUIKitInternal","onSDKConnected","getLocalUserInfo","userID","onRoomStateChanged","reason","errorCode","extendedData","onUserJoin","userList","console","log","length","onUserLeave","getSmallViewPostStyle","styleList","styles","smallViewPostTopLeft","smallViewPostTopRight","smallViewPostBottomLeft","smallViewPostBottomRgith","getSmallViewBorderStyle","smallViewBorder","switchLargeOrSmallView","container","smallView","bigView","StyleSheet","create","flex","width","height","emptyView","backgroundColor","position","zIndex","top","right","borderRadius","overflow","borderWidth","borderColor","left","bottom"],"sources":["PictureInPictureLayout.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport ZegoUIKitInternal from \"../../internal/ZegoUIKitInternal\";\nimport ZegoAudioVideoView from \"../../audio_video/ZegoAudioVideoView\";\nimport { StyleSheet, View, TouchableOpacity, Text } from 'react-native'\n\n// enum ZegoViewPostion {\n//     topLeft = 0,\n//     topRight = 1,\n//     bottomLeft = 2,\n//     bottomRight = 3\n//     }\nexport default function PictureInPictureLayout(props) {\n    const { config = {}, foregroundBuilder, audioVideoConfig = {} } = props;\n    const {\n        isSmallViewDraggable = false, // TODO\n        showMyViewWithVideoOnly = false,\n        smallViewBackgroundColor = '',\n        largeViewBackgroundColor = '',\n        smallViewBackgroundImage = '',\n        largeViewBackgroundImage = '',\n        smallViewPostion = 1,\n        switchLargeOrSmallViewByClick = true,\n    } = config;\n    const {\n        useVideoViewAspectFill = false,\n        showSoundWavesInAudioMode = true,\n    } = audioVideoConfig;\n\n    const [localUserID, setLocalUserID] = useState('');\n    const [remoteUserID, setRemoteUserID] = useState('');\n    const [showMeOnSmallView, setShowMeOnSmallView] = useState(true);\n\n    useEffect(() => {\n        const callbackID = 'PictureInPictureLayout' + String(Math.floor(Math.random() * 10000));\n        ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n            setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n        });\n        ZegoUIKitInternal.onRoomStateChanged(callbackID, (reason, errorCode, extendedData) => {\n            if (reason == 1 || reason == 4) {\n                setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n            } else if (reason == 2 || reason == 5 || reason == 6 || reason == 7) {\n                // ZegoRoomStateChangedReasonLoginFailed\n                // ZegoRoomStateChangedReasonReconnectFailed\n                // ZegoRoomStateChangedReasonKickOut\n                // ZegoRoomStateChangedReasonLogout\n                // ZegoRoomStateChangedReasonLogoutFailed\n                setLocalUserID('');\n                setRemoteUserID('');\n            }\n        })\n        ZegoUIKitInternal.onUserJoin(callbackID, (userList) => {\n            console.log('>>>>>>>>>>> join', userList)\n            if (userList.length == 1) {\n                setRemoteUserID(userList[0].userID);\n            } else {\n                //TODO\n            }\n        });\n        ZegoUIKitInternal.onUserLeave(callbackID, (userList) => {\n            console.log('<<<<<<<<<<<<<< leave', userList)\n            if (userList.length == 1) {\n                setRemoteUserID('');\n            } else {\n                //TODO\n            }\n        });\n        return () => {\n            ZegoUIKitInternal.onSDKConnected(callbackID);\n            ZegoUIKitInternal.onRoomStateChanged(callbackID);\n            ZegoUIKitInternal.onUserJoin(callbackID);\n            ZegoUIKitInternal.onUserLeave(callbackID);\n        }\n    }, [])\n    /*\n    enum {\n        topLeft = 0,\n        topRight = 1,\n        bottomLeft = 2,\n        bottomRight = 3\n    }\n    */\n    const getSmallViewPostStyle = () => {\n        const styleList = [styles.smallViewPostTopLeft, styles.smallViewPostTopRight, styles.smallViewPostBottomLeft, styles.smallViewPostBottomRgith];\n        if (smallViewPostion >= 0 && smallViewPostion <= 3) {\n            return styleList[smallViewPostion];\n        } else {\n            return styles.smallViewPostTopLeft;\n        }\n    }\n    const getSmallViewBorderStyle = () => {\n        if (showMeOnSmallView) {\n            return localUserID ? styles.smallViewBorder : ''\n        } else {\n            return remoteUserID ? styles.smallViewBorder : ''\n        }\n    }\n    const switchLargeOrSmallView = () => {\n        if (switchLargeOrSmallViewByClick) {\n            setShowMeOnSmallView(!showMeOnSmallView);\n        }\n    }\n\n    return (<View style={styles.container}>\n\n        <View  pointerEvents='auto' onTouchStart={switchLargeOrSmallView} style={[styles.smallView, getSmallViewPostStyle(), getSmallViewBorderStyle()]}>\n            {showMeOnSmallView ?\n                (localUserID ?\n                    <ZegoAudioVideoView\n                        key={localUserID}\n                        userID={localUserID}\n                        audioViewBackgroudColor={smallViewBackgroundColor}\n                        audioViewBackgroudImage={smallViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    /> :\n                    <View />) :\n                (remoteUserID ?\n                    <ZegoAudioVideoView\n                        key={remoteUserID}\n                        userID={remoteUserID}\n                        audioViewBackgroudColor={smallViewBackgroundColor}\n                        audioViewBackgroudImage={smallViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    /> :\n                    <View />)\n            }\n        </View>\n        <View style={styles.bigView}>\n            {showMeOnSmallView ?\n                (remoteUserID ?\n                    <ZegoAudioVideoView\n                        key={remoteUserID}\n                        userID={remoteUserID}\n                        audioViewBackgroudColor={largeViewBackgroundColor}\n                        audioViewBackgroudImage={largeViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    /> :\n                    <View />) :\n                (localUserID ?\n                    <ZegoAudioVideoView\n                        key={localUserID}\n                        userID={localUserID}\n                        audioViewBackgroudColor={largeViewBackgroundColor}\n                        audioViewBackgroudImage={largeViewBackgroundImage}\n                        showSoundWave={showSoundWavesInAudioMode}\n                        useVideoViewAspectFill={useVideoViewAspectFill}\n                        foregroundBuilder={foregroundBuilder}\n                    /> :\n                    <View />)\n            }\n        </View>\n    </View>)\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        width: '100%',\n        height: '100%',\n    },\n    emptyView: {\n        backgroundColor: '#4A4B4D'\n    },\n    bigView: {\n        flex: 1,\n        width: '100%',\n        height: '100%',\n        position: 'absolute',\n        backgroundColor: '#4A4B4D',\n        zIndex: 1,\n    },\n    smallView: {\n        flex: 1,\n        height: 169,\n        width: 95,\n        position: 'absolute',\n        top: 70,\n        right: 12,\n        zIndex: 2,\n        borderRadius: 10,\n        overflow: 'hidden',\n        backgroundColor: '#4A4B4D',\n    },\n    smallViewBorder: {\n        borderWidth: 0.5,\n        borderColor: '#A4A4A4',\n    },\n    smallViewPostTopLeft: {\n        top: 70,\n        left: 12,\n    },\n    smallViewPostTopRight: {\n        top: 70,\n        right: 12,\n    },\n    smallViewPostBottomLeft: {\n        bottom: 70,\n        left: 12,\n    },\n    smallViewPostBottomRgith: {\n        bottom: 70,\n        right: 12,\n    }\n})"],"mappings":"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"}