{"version":3,"names":["React","useEffect","useState","View","ScrollView","FlatList","StyleSheet","Text","TouchableWithoutFeedback","ZegoUIKitInternal","ZegoMicrophoneStateIcon","ZegoCameraStateIcon","Delegate","ZegoMemberList","props","showMicrophoneState","showCameraState","itemBuilder","localUserID","setLocalUserID","memberList","setMemberList","refreshMemberList","getAllUsers","reverse","index","findIndex","user","userID","getLocalUserInfo","splice","concat","arr","getShotName","name","nl","split","shotName","forEach","part","substring","iconMicView","item","require","iconCameraView","itemBuilderView","userInfo","renderItem","styles","itemLeft","avatar","nameLabel","userName","itemRight","callbackID","String","Math","floor","random","onSDKConnected","onRoomStateChanged","reason","errorCode","extendedData","onUserCountOrPropertyChanged","userList","create","width","flexDirection","alignItems","justifyContent","paddingLeft","paddingRight","height","backgroundColor","borderRadius","marginRight","flex","textAlign","color","fontSize","icon","marginLeft"],"sources":["ZegoMemberList.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { View, ScrollView, FlatList, StyleSheet, Text, TouchableWithoutFeedback } from 'react-native';\nimport ZegoUIKitInternal from '../internal/ZegoUIKitInternal'\nimport ZegoMicrophoneStateIcon from '../audio_video/ZegoMicrophoneStateIcon'\nimport ZegoCameraStateIcon from '../audio_video/ZegoCameraStateIcon';\nimport Delegate from \"react-delegate-component\";\n\nexport default function ZegoMemberList(props) {\n    const {\n        showMicrophoneState,\n        showCameraState,\n        itemBuilder,\n    } = props;\n    // let mockList = [\n    //     {\n    //       userID: 'bd7acbea',\n    //       userName: 'First Item',\n    //     },\n    //     {\n    //       userID: '3ac68afc',\n    //       userName: 'Second Item',\n    //     },\n    //     {\n    //       userID: '58694a0f',\n    //       userName: 'Third Item',\n    //     },\n    //     {\n    //         userID: '3ac68afa',\n    //         userName: 'Four Item',\n    //     },\n    //     {\n    //         userID: '58694a0b',\n    //         userName: 'Five Item',\n    //     },\n    //     {\n    //         userID: '3ac68af1',\n    //         userName: 'Six Item',\n    //     },\n    //     {\n    //         userID: '58694a0d',\n    //         userName: 'Seven Item',\n    //     },\n    // ];\n    const [localUserID, setLocalUserID] = useState('');\n    const [memberList, setMemberList] = useState([]);\n    \n    const refreshMemberList = () => {\n        // Update list like this will cause rerender\n        let memberList = ZegoUIKitInternal.getAllUsers();\n        memberList.reverse();\n        // Put yourself first\n        const index = memberList.findIndex((user => user.userID == ZegoUIKitInternal.getLocalUserInfo().userID));\n        index !== -1 && (memberList = memberList.splice(index, 1).concat(memberList));\n        setMemberList((arr) => [...memberList]);\n    };\n\n    useEffect(() => {\n        refreshMemberList();\n    }, []);\n\n    const getShotName = (name) => {\n        if (!name) {\n            return '';\n        }\n        const nl = name.split(' ');\n        var shotName = '';\n        nl.forEach(part => {\n            if (part !== '') {\n                shotName += part.substring(0, 1);\n            }\n        });\n        return shotName;\n    }\n\n    const iconMicView = item => showMicrophoneState ?\n        <ZegoMicrophoneStateIcon \n            iconMicrophoneOn={require(\"../internal/resources/gray_icon_video_mic_on.png\")}\n            iconMicrophoneOff={require(\"../internal/resources/gray_icon_video_mic_off.png\")}\n            iconMicrophoneSpeaking={require(\"../internal/resources/gray_icon_video_mic_speaking.png\")} \n            userID={item.userID}\n        /> : <View />;\n    const iconCameraView = item => showCameraState ?\n        <ZegoCameraStateIcon\n            iconCameraOn={require(\"../internal/resources/gray_icon_video_camera_on.png\")}\n            iconCameraOff={require(\"../internal/resources/gray_icon_video_camera_off.png\")}\n            userID={item.userID}\n        /> : <View />;\n    const itemBuilderView = item => itemBuilder ? <Delegate\n        to={itemBuilder}\n        props={{ userInfo: item }} /> : <View />\n\n    const renderItem = ({ item }) => (\n        !itemBuilder ? <View style={styles.item}>\n            <View style={styles.itemLeft}>\n                <View style={styles.avatar}>\n                    <Text style={styles.nameLabel}>{getShotName(item.userName)}</Text>\n                </View>\n                <Text style={styles.name}>{item.userName + (item.userID == ZegoUIKitInternal.getLocalUserInfo().userID ? ' (You)' : '')}</Text>\n            </View>\n            <View style={styles.itemRight}>\n                {iconMicView(item)}\n                {iconCameraView(item)}\n            </View>\n        </View> : itemBuilderView(item)\n    );\n\n    useEffect(() => {\n        const callbackID = 'ZegoMemberList' + String(Math.floor(Math.random() * 10000));\n        ZegoUIKitInternal.onSDKConnected(callbackID, () => {\n            setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n        });\n        ZegoUIKitInternal.onRoomStateChanged(callbackID, (reason, errorCode, extendedData) => {\n            if (reason == 1 || reason == 4) {\n                setLocalUserID(ZegoUIKitInternal.getLocalUserInfo().userID);\n            } else if (reason == 2 || reason == 5 || reason == 6 || reason == 7) {\n                // ZegoRoomStateChangedReasonLoginFailed\n                // ZegoRoomStateChangedReasonReconnectFailed\n                // ZegoRoomStateChangedReasonKickOut\n                // ZegoRoomStateChangedReasonLogout\n                // ZegoRoomStateChangedReasonLogoutFailed\n                setLocalUserID('');\n            }\n        })\n        ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID, (userList) => {\n            // Put yourself first\n            const index = userList.findIndex((user => user.userID == ZegoUIKitInternal.getLocalUserInfo().userID));\n            index !== -1 && (userList = userList.splice(index, 1).concat(userList));\n            setMemberList((arr) => [...userList]);\n        });\n        return () => {\n            ZegoUIKitInternal.onSDKConnected(callbackID);\n            ZegoUIKitInternal.onRoomStateChanged(callbackID);\n            ZegoUIKitInternal.onUserCountOrPropertyChanged(callbackID);\n        }\n    }, []);\n\n    return (<FlatList\n        data={memberList}\n        renderItem={renderItem}\n        keyExtractor={item => item.userID}\n    />);\n}\n\nconst styles = StyleSheet.create({\n    item: {\n        width: '100%',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        paddingLeft: 18,\n        paddingRight: 17,\n        height: 62,\n    },\n    itemLeft: {\n        flexDirection: 'row',\n        alignItems: 'center',\n    },\n    avatar: {\n        width: 36,\n        height: 36,\n        backgroundColor: '#DBDDE3',\n        borderRadius: 1000,\n        marginRight: 20,\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    nameLabel: {\n        flex: 1,\n        textAlign: 'center',\n        color: '#222222',\n        fontSize: 16,\n    },\n    name: {\n        fontSize: 16,\n        color: '#FFFFFF',\n    },\n    itemRight: {\n        flexDirection: 'row',\n        alignItems: 'center',\n    },\n    icon: {\n        width: 35,\n        height: 35,\n        alignItems: 'center',\n        justifyContent: 'center',\n        marginLeft: 12\n    },\n});"],"mappings":"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"}